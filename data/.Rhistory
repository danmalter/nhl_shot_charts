ifelse(shots$team_triCode == "CGY",  "#000000",
ifelse(shots$team_triCode == "COL",  "#6F263D",
ifelse(shots$team_triCode == "EDM",  "#FF4C00",
ifelse(shots$team_triCode == "VAN",  "#99999A",
ifelse(shots$team_triCode == "ANA",  "#000000",
ifelse(shots$team_triCode == "DAL",  "#111111",
ifelse(shots$team_triCode == "LAK",  "#A2AAAD",
ifelse(shots$team_triCode == "SJS",  "#000000",
ifelse(shots$team_triCode == "CBJ",  "#CE1126",
ifelse(shots$team_triCode == "MIN",  "#154734",
ifelse(shots$team_triCode == "WPG",  "#AC162C",
ifelse(shots$team_triCode == "ARI",  "#111111",
ifelse(shots$team_triCode == "VGK",  "#000000",
"darkgreen"))))))))))))))))))))))))))))))))
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime), 'to', max(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y")
head(events)
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime), 'to', max(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
min(shots$about_dateTime)
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(max(shots$about_dateTime), 'to', min(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
head(shots)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.Date(as.POSIXct(events$about_dateTime, tz = "GMT"))
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y")
events$about_dateTime <- as.Date(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
head(events)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- as.Date(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
players <- dbGetQuery(mydb, 'SELECT * FROM players')
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(format(events$about_dateTime, format = "%m/%d/%Y"), tz="America/New_York")
head(format(events$about_dateTime, format = "%m/%d/%Y"))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y")
events$about_dateTime <- format(events$about_dateTime, format = "%m/%d/%Y")
head(as.ITime(events$about_dateTime))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- as.POSIXct(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
events$about_dateTime <- as.POSIXct(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
players <- dbGetQuery(mydb, 'SELECT * FROM players')
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- as.POSIXct(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime)
head(events$about_dateTime)
events$about_dateTime <- as.POSIXct(format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y"))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York", format = "%m/%d/%Y")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York")
max(events$about_dateTime)
events$about_dateTime <- as.POSIXct(events$about_dateTime, format="%m/%d/%Y")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT")
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York")
max(events$about_dateTime)
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "America/New_York")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as.POSIXct(events$about_dateTime, tz = "GMT") # convert from character to UTC time (current time format)
events$about_dateTime <- format(events$about_dateTime, tz="America/New_York")
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
library(lubridate)
events$about_dateTime <- as.Date(events$about_dateTime)
head(events$about_dateTime)
head(mdy(events$about_dateTime))
events$about_dateTime <- ymd_hms(events$about_dateTime, tz = "UTC")
head(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- ymd(events$about_dateTime, tz = "UTC")
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
head(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
head(events$about_dateTime)
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
head(ymd(events$about_dateTime, tz = "America/New_York"))
head(with_tz(events$about_dateTime, "America/New_York"))
events$about_dateTime <- with_tz(events$about_dateTime, "America/New_York")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
tail(events$about_dateTime)
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "Z")
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
tail(as_datetime(events$about_dateTime, tz = "GMT"))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "GMT")
events$about_dateTime <- with_tz(events$about_dateTime, "America/New_York")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "America/New_York")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "GMT")
events$about_dateTime <- with_tz(events$about_dateTime, "America/New_York")
max(events$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
tail(events$about_dateTime)
tail(as_datetime(events$about_dateTime, tz = "GMT"))
tail(as_datetime(events$about_dateTime, tz = "UTC"))
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
tail(with_tz(events$about_dateTime, "America/New_York"))
events$about_dateTime <- tail(with_tz(events$about_dateTime, "America/New_York"))
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
events$about_dateTime <- with_tz(events$about_dateTime, "America/New_York")
max(events$about_dateTime)
tail(events$about_dateTime)
max(as.Date(events$about_dateTime))
max(as.Date(as.character(events$about_dateTime)))
tail(as.Date(as.character(events$about_dateTime)))
min(as.Date(as.character(events$about_dateTime)))
max(as.Date(as.character(events$about_dateTime)))
events$about_dateTime <- as.Date(as.character(events$about_dateTime))
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime), 'to', max(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
events$about_dateTime <- as.Date(with_tz(events$about_dateTime, "America/New_York"))
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime), 'to', max(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
events$about_dateTime <- as.Date(as.character(events$about_dateTime))
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime), 'to', max(shots$about_dateTime), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
# Change time from UTC to NY time zone
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
events$about_dateTime <- as.Date(with_tz(events$about_dateTime, "America/New_York"))
events$about_dateTime <- as.Date(as.character(events$about_dateTime))
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
tail(shots$about_dateTime)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
tail(shots)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime - 1), 'to', max(shots$about_dateTime - 1), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
# Change time from UTC to NY time zone
events$about_dateTime <- as_datetime(events$about_dateTime, tz = "UTC")
shots <- events %>%
# remove shots below goal line
filter(abs(coordinates_x) <= 90) %>%
filter(result_event == 'Shot' | result_event == 'Goal' & (playerType == 'Scorer' | playerType == 'Shooter')) %>%
filter(player_fullName == 'J.T. Compher')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(min(shots$about_dateTime - 1), 'to', max(shots$about_dateTime- 1), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
events$about_dateTime <- as.Date(with_tz(events$about_dateTime, "America/New_York"))
max(events$about_dateTime - 1)
max(events$about_dateTime - 2)
events <- dbGetQuery(mydb, 'SELECT *
FROM events')
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(format(min(as.Date(gv()$about_dateTime)), format = "%m/%d/%Y") - 1, 'to', format(max(as.Date(gv()$about_dateTime)), format = "%m/%d/%Y"), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
View(shots)
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(format(min(as.Date(shots$about_dateTime)), format = "%m/%d/%Y") - 1, 'to', format(max(as.Date(shots$about_dateTime)), format = "%m/%d/%Y"), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(format(min(as.Date(shots$about_dateTime) - 1), format = "%m/%d/%Y"), 'to', format(max(as.Date(shots$about_dateTime)), format = "%m/%d/%Y"), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
ggplot(shots, aes(x = coordinates_x, y = coordinates_y)) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
subtitle = paste(format(min(as.Date(shots$about_dateTime) - 1), format = "%m/%d/%Y"), 'to', format(max(as.Date(shots$about_dateTime) - 1), format = "%m/%d/%Y"), sep=' '),
x = NULL,
y = NULL) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
runApp('~/Documents/nhl/NHLShotCharts')
runApp('~/Documents/nhl/NHLShotCharts')
library(rvest)
library(rvest)
library(magrittr)
imageURL <- read_html("http://content.sportslogos.net/logos/1/7/thumbs/56.gif") %>%
html_nodes(css = "img") %>%
html_attr("src")
p <- ggplot(shots, aes(x = coordinates_x, y = coordinates_y,
text = paste('Result: ', result_event,
'<br>Shot Type: ', result_secondaryType,
'<br>Period: ', about_period,
'<br>Away Goals: ', about_goals_away,
'<br>Home Goals (goal included if scored): ', about_goals_home,
'<br>Team Name: ', team_name,
'<br>Description: ', result_description))) +
gg_rink(side = "right", specs = "nhl") +
gg_rink(side = "left", specs = "nhl") +
geom_point(aes(color = result_event , shape = result_event),
position = "jitter", size = 2, alpha = 1, stroke = .5) +
labs(title = paste(shots$player_fullName, "- Shot Chart", sep=" "),
x = NULL,
y = NULL) +
annotate("text", x = 2.5, y = -50, label = paste(format(min(as.Date(shots$about_dateTime) - 1), format = "%m/%d/%Y"), 'to', format(max(as.Date(shots$about_dateTime) - 1), format = "%m/%d/%Y"), sep=' ')) +
scale_color_manual(values = c("Shot" = shot_color, "Goal" = goal_color),
name = NULL) +
scale_shape_manual(values = c("Shot" = 4, "Goal" = 16),
name = NULL, ) +
scale_x_continuous(breaks = seq(-30, 30, by = 5)) +
scale_y_continuous(breaks = seq(-15, 15, by = 3)) +
theme(legend.title=element_blank(),
legend.position="bottom",
plot.title=element_text(hjust=0.5),
plot.subtitle=element_text(hjust=0.5),
axis.text.x=element_blank(),
axis.text.y=element_blank())
ggplotly(p, tooltip="text")
